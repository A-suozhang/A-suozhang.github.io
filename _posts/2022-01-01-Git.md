---
layout:     post                    # ä½¿ç”¨çš„å¸ƒå±€ï¼ˆä¸éœ€è¦æ”¹ï¼‰
title:      å¦‚ä½•ä½¿ç”¨Git            # æ ‡é¢˜ 
subtitle:   å›æ¡£å›æ¡£å›æ¡£å›æ¡£ï¼        #å‰¯æ ‡é¢˜
date:       2020-01-01   # æ—¶é—´
author:     tianchen                      # ä½œè€…
header-img:  img/1_28/nantong-3.jpg  #è¿™ç¯‡æ–‡ç« æ ‡é¢˜èƒŒæ™¯å›¾ç‰‡
catalog: true                       # æ˜¯å¦å½’æ¡£
tags:                               #æ ‡ç­¾
     - Coding
     - å¸¸ç”¨
     - ç¯å¢ƒé…ç½®
---

# å¦‚ä½•æ­£å¸¸ä½¿ç”¨git

> å°é‡‘é±¼A_suozhangéœ€è¦ä¸€äº›è®°å½•æ¥ä¿è¯è‡ªå·±ä¸ä¼šå¿˜è®°è¿™äº›å‘½ä»¤

## WorkFlow

### Simplest Example

* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200317152359.jpg)
* é¦–å…ˆ ```git init``` åˆ›å»ºä»“åº“
* å·¥ä½œæµï¼ˆ3æ£µæ ‘ï¼‰
  * ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20191202180520.png)
  * ä¸­é—´çš„æ˜¯index(æš‚å­˜åŒºï¼‰ï¼Œæ˜¯ä¸€ä¸ªç¼“å­˜åŒºåŸŸ
  * æœ€åçš„æ˜¯Headï¼ˆä¹Ÿå°±æ˜¯æŒ‡å‘æœ€åä¸€æ¬¡æäº¤(Commit)çš„ç»“æœï¼‰ï¼Œ*åˆ°äº†headè¿˜ä¸ä»£è¡¨åˆ°äº†remote repositoryè¿œç¨‹ä»“åº“*
* ```git add .```å°†å½“å‰ç›®å½•çš„æ”¹åŠ¨æš‚å­˜(Stage)
  * è¿™ä¸ªå‘½ä»¤å¯èƒ½ä¼šå°†ä¸€äº›å¥‡æ€ªçš„ä¸œè¥¿æ·»åŠ è¿›æ¥ï¼Œå»ºè®®æ˜¯ç”¨```git add -a```æ·»åŠ æ”¹åŠ¨åŒº(æ²¡stagedçš„ä¸åŠ )ï¼Œç„¶å```git commit -a```
* ```git commit -m "XXX"```å°†Indexä¸­çš„å†…å®¹æäº¤ç»™head
* ```git push ```æ¨é€æ”¹åŠ¨
  
### åˆ†æ”¯ (Branch)

> å…¶äº§ç”Ÿæ˜¯ä¸ºäº†ç‰¹æ€§å¼€å‘ç»ç¼˜ï¼Œåˆ›å»ºä»“åº“çš„æ—¶å€™ï¼Œé»˜è®¤åˆ†æ”¯ä¸ºâ€œMasterâ€

* åˆ›å»ºæ–°çš„åˆ†æ”¯ ```git checkout -b feature_x ```
  * åˆ é™¤æ–°çš„åˆ†æ”¯(å½“ç„¶ä½ é¦–å…ˆè¦åˆ‡å›ä¸»åˆ†æ”¯) ```git branch -d feature_x```
  * æ¨é€åˆ°å½“å‰åˆ†æ”¯ ```git push origin feature_x```
* åˆ‡æ¢å›åˆ°ä¸»åˆ†æ”¯ ```git checkout master```

### æ›´æ–°ä¸åˆå¹¶ 

* æ›´æ–°æœ¬åœ°ä»“åº“(Local Repo)åˆ°æœ€æ–°çš„æ”¹åŠ¨ ```git pull``` 
  * ç›¸å½“äºåœ¨ç›®å‰çš„ç›®å½•ä¸­è·å–(Fetch)å¹¶ä¸”åˆå¹¶(Merge)äº†è¿œç«¯(Remote)çš„æ”¹åŠ¨
  * è¿™é‡Œçš„mergeæ˜¯é»˜è®¤fast forwardçš„

* å¦‚æœä½ åªæƒ³åˆå¹¶å…¶ä»–æŸä¸ªåˆ†æ”¯åˆ°ä½ çš„å½“å‰åˆ†æ”¯ ```git merge branch```
* *æ‰§è¡Œä»¥ä¸Šä¸¤è€…çš„æ—¶å€™éƒ½è‡ªåŠ¨åˆå¹¶å†²çª(Conflict)ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¸æˆåŠŸï¼Œå°±è¦æ‰‹åŠ¨åˆå¹¶ï¼Œä¿®æ”¹å®Œä¹‹ååˆ©ç”¨```git add <Filename>```æ¥è¡¨å¾åˆå¹¶å®Œæ¯•ï¼Œåœ¨åˆå¹¶çš„æ—¶å€™åˆ©ç”¨```git diff <Source_Branch> <Target Branch>```*

* æ›¿æ¢æœ¬åœ°æ–‡ä»¶ï¼Œé‡‡ç”¨```git checkout <filename>```ç”¨headä¸­çš„æ–‡ä»¶æ›¿æ¢æœ¬åœ°çš„æ–‡ä»¶ï¼ˆä½†æ˜¯ä¸ä¼šæ”¹å˜stagedåŒºåŸŸï¼‰
	* [Tutorial Link](https://www.atlassian.com/git/tutorials/resetting-checking-out-and-reverting)
	* éœ€è¦åŒºåˆ†å’Œresetå’Œrevertçš„åŒºåˆ«
		* revert è¡¨ç¤ºå¯¹public branchæ’¤é”€commit,æ²¡æœ‰å¯¹æ–‡ä»¶æ“ä½œçš„æ–¹å¼
		* resetå¯¹æ–‡ä»¶æ“ä½œæ˜¯åšUnstage,è€Œå¯¹commitåšè¡¨ç¤ºæ’¤é”€æ‰€æœ‰æœªç»commitçš„å˜åŒ–
			* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200103191416.png)
			* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200103191529.png)
				* ```git checkout $FILENAME```æ˜¯å’Œç›´æ¥å’Œremoteé‡ç½®
		* checkoutå¯¹æ–‡ä»¶æ˜¯æ”¹å˜working directoryä¸­çš„å†…å®¹(ä¸ä¼šæ”¹å˜stageåŒºåŸŸ),å¯¹commitåšè¡¨ç¤ºåˆ‡æ¢branch
		* *å¯¹æŸä¸ªå…·ä½“çš„commitå¯ä»¥specify commit,like ```git reset HEAD~2```*
  * å°†Headå¤åˆ¶åˆ°äº†Local Repo

* ```git reset -- files ```æ’¤é”€æœ€åä¸€æ¬¡git add
  * ä¹Ÿå°±æ˜¯æ’¤é”€stageåŒºåŸŸ

* æ›¿æ¢æ•´ä¸ªæœ¬åœ°ä»“åº“ä¸ºäº‘ç«¯ç‰ˆæœ¬ï¼Œå…ˆè·å–æœåŠ¡å™¨çš„æœ€æ–°ç‰ˆæœ¬```git fetch origin```ï¼Œå°†æœ¬åœ°ä»“åº“æŒ‡å‘å®ƒ ```git reset --hard origin/master```

* **mergeä¸rebaseçš„åŒºåˆ«**
	* å½“æ‰§è¡Œgit pushçš„æ—¶å€™é»˜è®¤è¿›è¡Œäº†merge
	* å¦‚æœå½“åªæ˜¯æœ¬åœ°çš„å°æ”¹åŠ¨çš„è¯å¯ä»¥ä½¿ç”¨```git rebase -i origin/XXX```
		* rebaseå®Œäº†è¿˜æ˜¯è¦pushçš„å“¦
	
* git pullå’Œgit fetch
	* git pullç›¸å½“äºå…ˆfetchå†merge
	* git fetchä¸‹æ¥åªæ˜¯æ›´æ–°äº†.gitå†…éƒ¨çš„,å‹ç¼©è¿‡çš„æ–°ç‰ˆæœ¬ä»£ç 
		* è¿™æ ·å°±å¯ä»¥åˆ©ç”¨git diffæ¥æŸ¥çœ‹å’Œè¿œç¨‹çš„æœ‰ä»€ä¹ˆåŒºåˆ«äº†
	* [Dont Just Pull, Fetch & Merge](https://longair.net/blog/2009/04/16/git-fetch-and-merge/)
	* æ‰§è¡Œgit mergeä¹‹åå¦‚æœå‡ºç°å†²çª,gitä¼šç›´æ¥åœ¨ä½ çš„æ–‡ä»¶é‡Œä¿®æ”¹,å›å»æŠŠå†²çªæ¶ˆé™¤ä¹‹åå†addç„¶åcommitå°±å¥½äº†

* Git Mergeçš„ä¸¤ç§æƒ…å†µ (Fast-Forward or not) å‚è€ƒ[å‡ ä¸ªåŠ¨å›¾](https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1)
  * é»˜è®¤æ˜¯FFçš„ï¼ŒåŠ ä¸Š --no-ff ä¸å»ff
  * FFï¼šWhen Current Branch have no Commits, Merging branch
    * DO-NOT Create a new commit 
    * åªæ˜¯å•çº¯çš„æŠŠæ–°çš„branchè¿åˆ°äº†åŸæ¥çš„branchä¸Šå¹¶ä¸”æŠŠHEADæŒ‡å‘å…¶

* No-FFï¼šå¦‚æœå½“å‰çš„branchæœ‰æ–°çš„commit
    * ä¸€èˆ¬å‡ºç°åœ¨æˆ‘æœ¬åœ°æ”¹åŠ¨äº†ä¸€ä¸ªCommitï¼Œä½†æ˜¯åˆ«äººä¹Ÿå¾€Remoteä¸Šcommitäº†ï¼Œå¯¼è‡´ç°åœ¨çš„remoteå·²ç»ä¸æ˜¯ä¹‹å‰æˆ‘æœ¬åœ°çš„ç‰ˆæœ¬äº†
    * Git creates a new active Node (Merging Commit)
    * å½“å‘ç”ŸMerge CONFILCTçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨Fixå¹¶ä¸”è¿›è¡Œä¸€ä¸ªCommitï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ›å»ºäº†ä¸€ä¸ªMerge Commit

* å¯¹ä¸€ä¸ªBranchçš„å†…å®¹è¿›è¡Œæ›´æ–°çš„åŠæ³•é™¤äº†Mergeå°±æ˜¯Rebase
  * It copies the commit of current branch, and put it on top of the merging branch
  * ä½†æ˜¯ï¼Œrebaseä¼šç›´æ¥ç”¨ç°æœ‰çš„æƒ…å†µå»è¦†ç›–merging branchçš„å†…å®¹(å› ä¸ºé¦–å…ˆè¦è®©merging branchä¼šåˆ°Current branch commitä¹‹å‰çš„çŠ¶æ€)ï¼Œå› æ­¤ä¸ä¼šæœ‰MERGE CONFLICTï¼Œä¹Ÿä¸ä¼šæœ‰Merge CommitèŠ‚ç‚¹ï¼Œè®©æ•´ä¸ªå¼€å‘æ ‘ä¿æŒçº¿æ€§
  * å› ä¸ºå¾ˆå±é™©ï¼Œæ‰€ä»¥ä¸€èˆ¬è¦ç”¨rebase -iæ¥è¿›è¡Œæ§åˆ¶

* å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯Cherry-pick
  * å¦‚æœå¯¹å¦ä¸€ä¸ªbranchçš„å¤šä¸ªcommitä¸­åªæƒ³è¦å¼•å…¥ä¸€ä¸ªè¿›æ¥ï¼Œå¦‚æœmergeçš„è¯ä¼šå…¨éƒ½è€ƒè™‘è¿›æ¥ï¼Œå¯ä»¥ç”¨```git cherry-pick COMMIT_ID```

* Merge-Conflictçš„example
	* æ¯”å¦‚è¯´æˆ‘å…ˆåœ¨æœ¬åœ°åšäº†ä¿®æ”¹å¹¶ä¸”commitä¸”pushäº†ï¼Œpushçš„æ—¶å€™æŠ¥é”™è¡¨ç¤ºæˆ‘remoteæœ‰äº†æˆ‘æœ¬åœ°æ²¡æœ‰çš„æ›´æ”¹ï¼Œpullä¸‹æ¥ä¹‹åå‘ç°conflictäº†ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®å¤conflict
	* ä¼šå‡ºç°è¿™æ ·çš„é¢å¤–å†…å®¹
		* <<<< HEAD 
		* æˆ‘åˆšæ‰ä¿®æ”¹çš„å†…å®¹
		* =========
		* remoteä¸Šåˆ«äººä¿®æ”¹çš„å†…å®¹
		* ======> remote_commit ID
	

## è¡¥å……ï¼ˆComplementï¼‰ä¸å›é€€(reset/checkout/revert)

* ```git commit --amend``` å¯ä»¥å¿«æ·ä¿®æ”¹å½“å‰çš„commit
	* ç„¶ååœ¨amendå‡ºæ¥çš„æ–‡ä»¶é‡Œæ·»åŠ ç¬¬äºŒæ¬¡commitåšäº†å•¥,ä¿å­˜ä¹‹åé€€å‡º
	* å¦‚æœä¸Šä¸€ä¸ªcommitæ²¡æœ‰pushä¸Šå»,é‚£ä¹ˆä¼šç›´æ¥æ›¿ä»£æ²¡æœ‰å…³ç³»
	* å¦‚æœä¸Šä¸€ä¸ªå·²ç»pushä¸Šå»äº†,ç”±äºéœ€è¦è¦†ç›–ä¼šå†²çª,æ‰€ä»¥éœ€è¦ç”¨```git push -f```

---

### å›é€€ reset/checkout/revert

#### åœ¨Commitå±‚é¢

1. resetï¼šå°†æŸä¸ªåˆ†æ”¯çš„æœ«ç«¯æŒ‡å‘æŸä¸ªæäº¤
  * ```git reset HEAD~2``` - å°†å½“å‰branchçš„å›é€€ä¸¤ä¸ªcommit
    * æœ‰Softå’ŒHardä¸¤ç§ï¼Œå¯ä»¥ç”¨```git reset --soft HEAD~2```æ¥æŒ‡å®šï¼Œsoftçš„è¯åªä¼šç§»åŠ¨HEADçš„æŒ‡å‘çš„ä½ç½®ï¼Œåé¢çš„ä¸¤ä¸ªCommitä¾ç„¶æ˜¯å¯ä»¥Accessçš„ï¼Œä½†æ˜¯hardçš„è¯æœ€åçš„ä¸¤ä¸ªcommitå°†è¢«åˆ é™¤(ä¹ŸåŒ…æ‹¬æœ¬åœ°çš„Stageä»¥åŠWorking Directoryä¸­çš„æ–°æ–‡ä»¶)
  * ç›¸å¯¹å±é™©ï¼Œè¯·åªç”¨äºprivate repo
2. checkout - ä¸€èˆ¬ç”¨äºåˆ‡æ¢åˆ†æ”¯
  * é™¤äº†æ¢åˆ†æ”¯ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åˆ‡æ¢åˆ°åˆ«çš„æäº¤```git checkout HEAD~2```
  * gitä¼šå¼ºåˆ¶è¦†ç›–æœ¬åœ°çš„æ‰€æœ‰æ›´æ”¹ï¼Œæ‰€ä»¥Gitä¼šè¦æ±‚ä½ é¢„å…ˆStageæ‰€æœ‰çš„æ›´æ”¹ï¼ŒæŸåˆ™éƒ½ä¼šä¸¢å¤±
3. revertç›¸å¯¹å®‰å…¨ï¼Œåœ¨æ’¤é”€ä¸€ä¸ªæäº¤çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Commitï¼Œå®ƒå¹¶ä¸ä¼šé‡å†™commitå†å²ï¼Œåªæ˜¯æ‰¾å‡ºä¸€ä¸ªcommitï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ–°çš„commitåŠ å…¥ ```git revert HEAD~2```
   * ä¿å­˜äº†ä¹‹å‰çš„æ‰€æœ‰ï¼Œåªæ˜¯æ–°åŠ äº†ä¸€ä¸ª 

#### åœ¨Fileå±‚é¢

1. reset - å°†ç¼“å­˜åŒº(Stash)åŒæ­¥åˆ°ä½ æŒ‡å®šçš„Commit ```git reset HEAD~2 foo.py```ä¸ä¼šå½±å“Working Directoryä¸­çš„æ–‡ä»¶
2. checkout - ç±»ä¼¼ï¼Œå°±æ˜¯æ”¹å˜Working Directoryä½†æ˜¯ä¸æ”¹å˜Stash
  

## æŸ¥çœ‹ä¿¡æ¯

* ```git status```
* ```git reflog```
* ```git log``` æŸ¥çœ‹ä»¥å¾€çš„commitéƒ½åšäº†ä»€ä¹ˆ (å¦‚æœéœ€è¦æ¯”è¾ƒç²¾ç®€çš„ä¾¿äºæŸ¥æ‰¾IDç”¨```git reflog```ï¼Œç„¶åé€šè¿‡resetè·å¾—ç¥ç§˜çš„æ—¶å…‰æœºæ•ˆæœ)
* ```git log --graph```
	* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200103190137.png)
* ```git remote -V```
	* æ²¡æœ‰ä»€ä¹ˆåµç”¨çš„åŠŸèƒ½
	* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200103190234.png)
* ```ls .git/refs/remotes/origin/```
	* ```git branch -r```
* ``git show``` æŸ¥çœ‹å½“å‰commitçš„ä¿®æ”¹æƒ…å†µ




### Gitignore
#### Tempelate
* å¯ä»¥ä½¿ç”¨[Gitå®˜æ–¹æä¾›çš„ä¸€äº›æ¨¡æ¿](https://github.com/github/gitignore),å¯ä»¥æ’é™¤æ‰Buildæ‰€äº§ç”Ÿçš„æ–‡ä»¶

#### Place
* å°±æ”¾åœ¨.gitæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•

### Usage
* ä¿å­˜.gitginoreä¹‹åå¯ä»¥ä½¿ç”¨```git status```æ¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®(Vscodeç›´æ¥ç”¨gitæ¡†å­é‡Œé¢çœ‹)
* ä¹Ÿå¯ä»¥ç”¨```git check-ignore -v XXX```
* ä¸»è¦ç”¨åˆ°çš„ (æ”¯æŒé€»è¾‘é€šé…)
  *   *.pth
  *   folder1/folder2   
*  å·²ç»ä¸Šä¼ çš„,åä¿®æ”¹äº†gitignore (æ¸…ç©ºç¼“å­˜å¯ä»¥è§£å†³)
```
git rm -r --cached .
add .
```

* ä¸€äº›ç®€å•çš„æ¨¡æ¿

```

#æ³¨é‡Š           .gitignoreçš„æ³¨é‡Š
*.txt           å¿½ç•¥æ‰€æœ‰ .txt åç¼€çš„æ–‡ä»¶
!src.a          å¿½ç•¥é™¤ src.a å¤–çš„å…¶ä»–æ–‡ä»¶
/todo           ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ todo æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ src/todo
build/          å¿½ç•¥ build/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè¿‡æ»¤æ•´ä¸ªbuildæ–‡ä»¶å¤¹ï¼›
doc/*.txt       å¿½ç•¥docç›®å½•ä¸‹æ‰€æœ‰ .txt åç¼€çš„æ–‡ä»¶ï¼Œä½†ä¸åŒ…æ‹¬docå­ç›®å½•çš„ .txt çš„æ–‡ä»¶

bin/:           å¿½ç•¥å½“å‰è·¯å¾„ä¸‹çš„ bin æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸å¿½ç•¥ bin æ–‡ä»¶
/bin:           å¿½ç•¥æ ¹ç›®å½•ä¸‹çš„ bin æ–‡ä»¶
/*.c:           å¿½ç•¥ cat.cï¼Œä¸å¿½ç•¥ build/cat.c
debug/*.obj:    å¿½ç•¥debug/io.objï¼Œä¸å¿½ç•¥ debug/common/io.objå’Œtools/debug/io.obj
**/foo:         å¿½ç•¥/foo, a/foo, a/b/fooç­‰
a/**/b:         å¿½ç•¥a/b, a/x/b, a/x/y/bç­‰
!/bin/run.sh    ä¸å¿½ç•¥binç›®å½•ä¸‹çš„run.shæ–‡ä»¶
*.log:          å¿½ç•¥æ‰€æœ‰ .log æ–‡ä»¶
config.js:      å¿½ç•¥å½“å‰è·¯å¾„çš„ config.js æ–‡ä»¶

/mtk/           å¿½ç•¥æ•´ä¸ªæ–‡ä»¶å¤¹
*.zip           å¿½ç•¥æ‰€æœ‰.zipæ–‡ä»¶
/mtk/do.c       å¿½ç•¥æŸä¸ªå…·ä½“æ–‡ä»¶

```

* å¯ä»¥ç›´æ¥ç”¨`git clone`å°†ä»“åº“æ‹·è´åˆ°æœ¬åœ°çš„å…¶ä»–ä½ç½®


# å…·ä½“æ“ä½œCheatSheet


#### å¯¹æŸä¸ªrepoå…å¯†ç push

* æ‰“å¼€è¯¥å·¥ç¨‹ç›®å½•ä¸‹çš„.git/config
  * å°†urlæ”¹æˆ```https://A-suozhang:$PASSWD@github.com/A-suozhang/$REPO_NAME```

* è®¾ç½®å…¨å±€çš„gitignore,é¦–å…ˆæ‰§è¡Œ ```git config --global core.excludesfile ~/.gitignore```
	* æ­¤æ—¶çš„``~/.gitconfig```ä¼šå˜æˆè¿™æ ·(å½“ç„¶ä½ æ‰‹åŠ¨åŠ å…¥æŒ‡ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„)
	* ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200108143420.png)
* ç„¶åç¼–è¾‘æ ¹ç›®å½•ä¸‹çš„gitignoreè‡ªåŠ¨å’Œæœ¬æœºçš„gitç»‘å®š

---

* åŒç†å¯ä»¥åœ¨gitconfigä¸­å»ºç«‹è´¦æˆ·ä¿¡æ¯
	* ```git config --global user.email```

#### å…å¯†ç Token

- `git config --global credential.helper store`ï¼Œå¯†ç ä¼šç”Ÿæˆåœ¨`~/.git-credential`

#### æš´åŠ›PUSH
* å› ä¸ºå„ç§æ“ä½œï¼ˆæ¯”å¦‚å›é€€åˆ°äº†ä¹‹å‰çš„Commitï¼‰å¯èƒ½ä¼šå‡ºç°```Your Repo Is Behind master/branch by 2 commit, try git pull first```ç°åœ¨ç†è®ºä¸Šæ˜¯ä¸èƒ½commitä¹Ÿä¸èƒ½pushçš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦push
* ```git push --force``` (è°¨æ…å•Š)

#### å¼ºè¡Œå›é€€ç‰ˆæœ¬
1. é¦–å…ˆ ```git log```æŸ¥çœ‹å†å²Commit,æ‰¾åˆ°è‡ªå·±æƒ³è¦å›åˆ°çš„é‚£ä¸€æ¬¡,è®°å½•ä¸‹æ¥COMMIT_ID
2. æ‰§è¡Œ ```git reset --hard COMMIT_ID```
  * ç›¸å½“äºç›´æ¥åˆ é™¤å¯¹åº”çš„commit
3. æˆ–è€…æ˜¯ ```git revert COMMIT_ID```
  * ç›¸å½“äºç”¨ä¸€æ¬¡æ–°çš„commitæ¥å›æ»šåˆ°ä¹‹å‰çš„commit

#### Commit å®Œäº†ä¹‹åå‘ç°è¿˜éœ€è¦æ”¹ä¸ªä»€ä¹ˆä¸œè¥¿

1. ```git add $SOME_FILE```
2. ```git commit --amend --no-edit```
3. (å¦‚æœå·²ç»pushåˆ°remoteä¸Šï¼Œé‚£ä¹ˆå†```git push -f```)

#### Git Addä¹‹åéœ€è¦æ’¤é”€

1. ```git reset HEAD ./XXX```
* è¿™æ ·åšçš„è¯ä¸ä¼šå®é™…æ”¹å˜æ–‡ä»¶,è€Œ```git checkout```åˆ™ä¼šä¸¢å¼ƒæœ¬åœ°ä¿®æ”¹
* This act means **Unstage**   


#### æµ‹è¯•æ›´æ–°ä¸Branch

* é¦–å…ˆæˆ‘æ–°å»ºä¸€ä¸ªæ–‡ä»¶```testGit.sh```
  * ```git add . ```è¿‡å»ï¼ŒæŸ¥çœ‹```git status```æ˜¾ç¤ºæ–°å¢äº†ä¸€ä¸ªæ–‡ä»¶
  * ```git reset --file testGit.sh```ä¹‹å```git status```å‘ç°æ˜¾ç¤ºç›®å‰è¿˜æœ‰testGit.shè¿™ä¸ªæ–‡ä»¶æ²¡æœ‰æäº¤
* Addhå›æ¥ï¼ŒCommitä¸Šå»```git commit -m "Adding testGit.sh"```,åŒæ­¥åˆ°äº†HEAD
* æ–°å»ºä¸€ä¸ªbranch ```git checkout -b branch0```
* æŠŠHEAD pushåˆ°æ–°çš„branchä¸Š ```git push origin branch0```
* åˆ‡æ¢å›åˆ°master branchï¼Œ ```git checkout master```
* ç›´æ¥ ```git pull```ï¼Œå®Œæˆä¹‹åå‘ç°æ–°çš„æ–‡ä»¶testGitæ²¡æœ‰äº†(åˆç†ï¼Œå› ä¸ºmaster branchä¸Šå¹¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶)
* åˆ‡æ¢åˆ°```git checkout branch0```ï¼Œç„¶å```git pull```ä½†æ˜¯å¤±è´¥äº†ï¼Œå°è¯•```git pull origin branch0```ï¼Œæ–‡ä»¶åˆå›æ¥äº†
* æ‰§è¡Œ```git diff master origin```å¯¹æ¯”å‡ ä¸ªbranch
  * ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20191202192429.png)
* ```git branch -vv```æŸ¥çœ‹å¯¹æ¯ä¸ªbranchåšäº†ä»€ä¹ˆ
  * ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20191202192500.png)
* ```git branch```æŸ¥çœ‹å½“å‰çš„åˆ†æ”¯(å¸¦æ˜Ÿå·çš„æ˜¯)
* ```git checkout master; git merge branch0``` åˆå¹¶åˆ†æ”¯
* ```git branch -d branch0```åˆ é™¤åˆå¹¶åçš„åˆ†æ”¯

#### å½“ç®€å•ä¿®æ”¹çš„æ—¶å€™ä½¿ç”¨rebaseæ¥ç²¾ç®€graph

> è¿™é‡Œæ²¡å†™æ¸…æ¥šï¼Œçœ‹ä¸‹é¢

* è¿™ä¸ªä¸€èˆ¬èˆ¬ - [lxfæ•™ç¨‹](https://www.liaoxuefeng.com/wiki/896043488029600/1216289527823648)
* [Git Book](http://gitbook.liuhui998.com/4_2.html)
  * è¿™ä¸ªè®²çš„å¾ˆæ¸…æ¥š
1. å½“ä½ ä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œadd-commitå®Œäº†æƒ³æŠŠå®ƒæ¨åˆ°è¿œç¨‹å»ï¼Œä½†æ˜¯è¿œç¨‹ä»“åº“å·²ç»è¢«äººä¿®æ”¹äº†
2. è¿™ä¸ªæ—¶å€™æ™®éæ“ä½œæ˜¯å…ˆpullä¸‹æ¥ï¼Œç„¶åå†mergeï¼Œä½†æ˜¯ä½ ä¸‹æ¬¡commitçš„æ—¶å€™å°±ä¼šå‡ºç°ä¸€ä¸ª```merge comit```æ‰èƒ½pushä¸Šå»
3. ä¸ä¹‹æ›¿ä»£ï¼Œä½ å¯ä»¥```git rebase origin/XXX```
   * è¿™ä¸ªæ“ä½œä¼šæŠŠä½ ä¹‹å‰çš„commitç»™å–æ¶ˆæ‰ï¼Œå¹¶ä¸”åœ¨æ–°çš„originåé¢appendæ–°çš„ä¿®æ”¹
4. rebaseçš„è¿‡ç¨‹ä¸­ä¼šå‡ºç°conflictï¼Œè§£å†³ä¹‹åç”¨git addï¼Œç„¶åä¸ç”¨commitï¼Œå¯ç”¨```git rebase --continue``` 
5. å¦‚æœä¸­é€”æ”¾å¼ƒï¼Œå¯ä»¥```git rebase --abort```


#### Git Stash

> å½“å¼€å‘äº†ä¸€åŠï¼Œä½†æ˜¯æƒ³è¦ä»remoteåŒæ­¥ä»£ç çš„æ—¶å€™

* å…ˆç”¨```git stash```æŠŠå†…å®¹æš‚å­˜ä¸‹æ¥
* ç„¶åå¯ä»¥æ­£å¸¸çš„è¿›è¡Œpushå’Œpullï¼Œcommit (stashä¹‹åæ˜¯å¯ä»¥æ­£å¸¸çš„fetch mergeçš„)
* ```git stash pop```
* ```git stash drop```

#### Git Show

> æƒ³è¦æŸ¥çœ‹æŸä¸ªcommitçš„ä¿®æ”¹çš„æ—¶å€™

* ```git log``` æŸ¥çœ‹commitçš„å“ˆå¸Œå€¼
  * ![](https://github.com/A-suozhang/MyPicBed/raw/master/img/20200220092339.png)
* ```git show```æŸ¥çœ‹æœ€æ–°çš„commit
* ```git show COMMIT_ID``` æŸ¥çœ‹æŸä¸ªcommitçš„ä¿®æ”¹
* ```git show COMMIT_ID FILENAME``` æŸ¥çœ‹æŸä¸ªcommitçš„æŸä¸ªæ–‡ä»¶çš„ä¿®æ”¹

#### å¯¹äºä¸æ˜¯cloneä¸‹æ¥çš„æ–°é¡¹ç›®

* æ­£å¸¸çš„git addä»¥åŠcommit
* ```git remote add https://XXX.git```
* ```git push -u origin master```


#### Add Deletd Files while Metting "it does not exist"

* For single file, use ```git add -u $SOME_FILE```
* For the folder, use ```git rm -r --cached $SOME_FOLDER```
* Or ```git add `git ls-files --deleted` ```


#### å¯¹äºåœ¨ä¸åŒçš„æœ¬åœ°æœåŠ¡å™¨ä¹‹é—´è¿›è¡Œä»“åº“çš„åŒæ­¥

* å…¶å®å’Œæ­£å¸¸flowåŸºæœ¬ä¸€æ ·,åªæ˜¯å°†åŸæœ¬çš„remote (å¯ä»¥ç”¨```git remote -v```æ¥æè¿°)
   * å°†åŸæœ¬çš„gitæœåŠ¡å™¨ä¸Šçš„(```https://github.com/A-suozhang./aw_nas```)åˆ‡æ¢æˆ```ztc.eva8.nics.cc:/home/zhaotianchen/code/aw_nas```
       * å°†ä¸Šé¢çš„è¿æ¥åŠ å…¥git cloneå³å¯
	   * ä¸¤è€…åŒæ ·éœ€è¦commitä¸add

#### ä¿®æ”¹remoteçš„åœ°å€

* é¦–å…ˆå¯ä»¥```git remote -v```çœ‹ç°åœ¨çš„remoteæ˜¯å“ªä¸ªåœ°å€-æ€»ä¹‹æ˜¯ä¸ªurlï¼Œå¯ä»¥æ˜¯å’ŒgithubæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°æœåŠ¡å™¨
	* æˆ–è€…å¯ä»¥é€šè¿‡æŒ‡å®šå“ªä¸ªremote(ä¸€èˆ¬æ¥è¯´é»˜è®¤æ˜¯origin)æ¥æŸ¥çœ‹å¯¹åº”çš„remoteåœ°å€```git remote origin```
	* åŒç†pushçš„æ—¶å€™ä¹Ÿå¯ä»¥æŒ‡å®špushåˆ°å“ªä¸ªremote
1. ```git remote set-url origin http://xxx.git``` 
2. å…ˆåˆ é™¤å†å»ºç«‹
	* ```git remote rm origin```
	* ```git remote add origin https://```
3. ä¿®æ”¹é…ç½®æ–‡ä»¶
	* è¿›å…¥```.git/config```

### å½“ä½ ç»‘å®šäº†å¤šä¸ªremoteçš„æ—¶å€™

* å¯ä»¥ç”¨```git remote -v```æ¥æŸ¥çœ‹remoteçš„åå­—å’Œurl
* æ³¨æ„pushçš„æ—¶å€™è¦æŒ‡å®špushåˆ°å“ªä¸€ä¸ªremote
* pullçš„æ—¶å€™åŒç†
	* æ³¨æ„å½“ä½ çš„branchä¸åœ¨masterçš„æ—¶å€™ï¼Œå¦‚æœä½ æƒ³è¦å’ŒæŸä¸ªremoteåŒæ­¥ï¼Œéœ€è¦åœ¨pullæ—¶å€™æŒ‡å®šremoteå’Œbranchçš„åå­—
	* æ¯”å¦‚```git pull a-suozhang bnn```

### å¯¹äºaddä»¥åŠcommitä¸éœ€è¦æ¯ä¸ªéƒ½addè¿™ä»¶äº‹

* è¯´èµ·æ¥éå¸¸æƒ­æ„§åˆ°ç°åœ¨æˆ‘æ‰æ˜ç™½
* åœ¨git statusä¸­
	* changes not staged for commit æ˜¯ä¸éœ€è¦æ‰‹åŠ¨é€šè¿‡addåŠ å…¥çš„
	* åªæœ‰ä¸‹é¢çš„untracked fileéœ€è¦æ‰‹åŠ¨åŠ å…¥
* åœ¨commitä¸­æŒ‡å®š-aå°±å¯ä»¥ä¸Šé¢ç¬¬ä¸€ç±»ä¸­çš„æ‰€æœ‰å†…å®¹å…¨éƒ¨ç»™commitä¸Šå»

### [rebase](justmysocks.xyz/buy-justmysocks/?source=get)çš„ç†è§£

> åˆä¸€æ¬¡å‘ç°è‡ªå·±ä¹‹å‰æ²¡æœ‰ææ¸…æ¥šï¼Œæˆ‘çœŸçš„æ˜¯ä¸ªå‚»é€¼

* [ä¸€ä¸ªæ–°çš„åšå®¢ï¼Œè®²çš„æ›´æ¸…æ¥šäº†ä¸€ç‚¹](http://jartto.wang/2018/12/11/git-rebase/)

### ä¸€æ¬¡æ–°çš„å¼€å‘ä¾‹å­

* æˆ‘ç°åœ¨éœ€è¦å›é€€å‡ ä¸ªcommitï¼Œå°†å®ƒä»¬åˆèµ·æ¥ï¼ŒåŒæ—¶è¿™ä¹‹é—´è¿˜ä¼šå­˜åœ¨ä¸€ä¸ªåˆ†æ”¯çš„splitåˆmergeçš„é—®é¢˜
* ![](https://github.com/A-suozhang/MyPicBed/raw/master//img/445faa4e92157337e4a548f837ec475.png)
	* å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘éœ€è¦å›åˆ°add layer2 ssè¿™ä¸ªåœ°æ–¹ï¼Œå¹¶ä¸”ä¿ç•™add final modelï¼Œå°†å…¶ä»–çš„commitå…¨éƒ¨åˆå¹¶æˆä¸€ä¸ª
* ```git reflog```æˆ–è€…```git log```æ¥è·å¾—commit-id
* ç”¨```git rebase -i (COMMIT_ID)``` - å…¶ä¸­COMMIT-IDæ˜¯add final modelçš„COMMIT-ID
* è¿›å…¥äº¤äº’ç•Œé¢ï¼Œ(é»˜è®¤è²Œä¼¼æ˜¯nanoç¼–è¾‘å™¨ï¼Œå¯ä»¥ç”¨```git config --global core.editor "vim"```ä¿®æ”¹é…ç½®ç”¨vim)
* å¦‚å›¾æ‰€ç¤ºä¿®æ”¹   ![](https://github.com/A-suozhang/MyPicBed/raw/master//img/20200923151827.png)
	* å®ƒæ‰¾å‡ºäº†åœ¨add final modelå‰é¢(åŒæ—¶)çš„4ä¸ªcommit(Merge commitè²Œä¼¼è¢«çœç•¥äº†)
	* ä¸‹é¢çš„æ³¨é‡Šä¼šå‘Šè¯‰ä½ å¦‚ä½•æ“ä½œï¼Œæ¯”å¦‚fçš„æ„æ€æ˜¯fixupï¼Œè·³è¿‡ä¸æ˜¾ç¤ºcommitå†…å®¹,pickè¡¨ç¤ºå°±æ˜¯ä¿ç•™
	* åœ¨æˆ‘ä»¬çš„caseé‡Œ:è¢«pickä¸‹çš„æ˜¯add controllerè¿™ä¸ªcommitï¼Œå¦‚æœä¸ä¿®æ”¹åå­—çš„è¯ä¸Šé¢çš„æ‰€æœ‰çš„commitå°±ä¼šè¢«åˆæˆè¿™ä¸ªcommit
* å¦‚æœå‡ºç°äº†conflictï¼ˆå¤§æ¦‚ç‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä½ rebaseçš„è¿™ä¸ªcommitå¦‚æœä¸ç°åœ¨çš„åˆ†æ”¯å‡ºç°äº†conflict(è‚¯å®šæœ‰ï¼Œå› ä¸ºfinal modelè¿™ä¸ªcommitè¢«æˆ‘mergeè¿‡)ï¼Œé‚£ä¹ˆå°±ä¼šéœ€è¦æ‰‹åŠ¨fix
	* git addä¹‹å```git rebase --continue```å°±å¥½äº†
* åœ¨ä»»ä½•æ—¶å€™å‘ç°é”™äº†ï¼Œå¯ä»¥ç›´æ¥```git rebase --abort```

* **æ€»ä¹‹ï¼Œgit rebaseå°±æ˜¯å°†åœ¨æŒ‡å‘commitä¹‹åçš„æ‰€æœ‰commitï¼Œåˆæˆä¸€ä¸ªcommit,appendåœ¨å®ƒåé¢**
	* ä¸ä¹‹åŒç­‰çº§çš„(ä¸åŒçš„åˆ†æ”¯å‡ºå»çš„)ï¼Œéƒ½è®¤ä¸ºåœ¨å…¶ä¹‹å,
---

* **ç°åœ¨å®Œå…¨çœ‹ä¸æ‡‚æˆ‘ä¸‹é¢è®°çš„æ˜¯ä»€ä¹ˆåŠä¸œè¥¿**
* å…ˆcheckoutåˆ°æŸä¸ªbranchï¼ŒæŠŠå…¶ä»–branchçš„å†…å®¹ç»™rebaseè¿‡æ¥
* ![image](https://user-images.githubusercontent.com/25324931/92607352-9c7c1980-f2e6-11ea-9b5e-9556c96bec9d.png)

### å¼ºåˆ¶å›é€€ç‰ˆæœ¬

> æˆ‘æ„Ÿè§‰æˆ‘å¥½åƒåœ¨ä»€ä¹ˆåœ°æ–¹å·²ç»è®°è¿‡è¿™ä¸ªä¸€æ¬¡äº†

* git logæŸ¥çœ‹COMMIT_ID
* ```git reset --hard COMMIT_ID```
* å¦‚æœä½¿ç”¨ ```git checkout COMMIT_ID```ä¼šå‡ºç°HEAD Detachçš„ç°è±¡ï¼Œå¯¼è‡´ä¸åœ¨ä»»ä½•ä¸€ä¸ªbranchä¸Šé¢

### 2021gitæ›´æ–°äº†ä¸è®©ç”¨å¯†ç è€Œæ˜¯ç”¨tokenè¿›è¡Œç™»å½•

- since push needs token now, use this command to save the token after your push `git config --global credential.helper store`
- æˆ–è€…ç”¨sshå’ŒgitæœåŠ¡å™¨è¿›è¡Œç™»å½•ï¼Œè²Œä¼¼å¯ä»¥é¿å…ç§‘å­¦ä¸Šç½‘(*)
	- ä½†æ˜¯maybeä¼šå‡ºç°å…¶ä»–é—®é¢˜

### ä¸å»trackæŸäº›æ–‡ä»¶

- æ¯”å¦‚ä¸€äº›ç»å¸¸éœ€è¦æ›´æ–°çš„trainçš„é…ç½®æ–‡ä»¶ï¼Œæœ¬æ¥ä¸åº”è¯¥æ¯æ¬¡gitæ›´æ–°éƒ½æ›´æ–°ï¼Œä½†æ˜¯æˆ‘åˆæƒ³ä¿å­˜è¿™ä¸ªæ–‡ä»¶
- æ–¹æ¡ˆ1ï¼šä½¿ç”¨`git rm --cached`ï¼ˆè¿™æ ·åšä¼šç›´æ¥åœ¨remoteåˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™çœ‹git statusä¼šæ˜¾ç¤ºdeleted fileï¼‰å¦‚æœåªç”¨`git rm`çš„è¯ï¼Œç”šè‡³å½“å‰å·¥ä½œåŒºä¸­çš„ä¹Ÿä¼šè¢«ç§»é™¤(å¹¶ä¸æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚)
- ä½¿ç”¨`git update-index --skip-worktree kitti-train-mp.sh`
	- ä½†æ˜¯è¦æ³¨æ„ä½¿ç”¨æœ¬å‘½ä»¤çš„æ—¶å€™ï¼Œworking treeä¸­æœ¬èº«ä¸èƒ½æœ‰å¯¹è¯¥æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå¦åˆ™å°±ä¼šå‡ºç°ä¸€äº›å¥‡å¦™é”™è¯¯*,å¦‚æœåœ¨å…¶ä»–åˆ†æ”¯å‡ºç°äº†é—®é¢˜çš„è¯,å°±éœ€è¦æ‰‹åŠ¨mergeè€Œä¸”å¾ˆå¤æ‚
- æ‰€ä»¥ä»¥ä¸Šçš„æ–¹å¼åªèƒ½ä½œä¸ºä¸€ä¸ª`.gitignore`çš„æ¯”è¾ƒå¥½çš„æ›¿ä»£,ä½†æ˜¯å¥½åƒè¿˜æ˜¯ä¸èƒ½å¾ˆå¥½çš„è¾¾åˆ°æƒ³ä¸å»trackæŸäº›æ–‡ä»¶çš„ä½œç”¨,è¦æ˜¯çœŸçš„æƒ³è¿™æ ·,å¤§æ¦‚ç‡è¿˜æ˜¯ç”¨æ–¹æ¡ˆ1

### pushåˆ°ä¸€ä¸ªé€šè¿‡æœåŠ¡å™¨ä¹‹é—´ssh cloneæ¥çš„repoæŠ¥é”™

- ![](https://github.com/A-suozhang/MyPicBed/raw/master//img/20211018105259.png)
- æœ¬è´¨åŸå› æ˜¯å› ä¸ºsource repoä¸æ˜¯ä¸€ä¸ªbare-rep
	- æˆ‘ç°åœ¨çš„caseæ˜¯æˆ‘åœ¨eva3(eva3ä¸Šçš„repoæ˜¯ä»eva1ä¸Šå¤åˆ¶è¿‡æ¥çš„)ä¸Šä¿®æ”¹äº†æ–‡ä»¶ï¼Œæˆ‘ç»™å®ƒpushåˆ°eva1ä¸Šçš„æ—¶å€™æŠ¥é”™äº†

### Git Diffä¸å‡ºä¸œè¥¿,ä½†æ˜¯ä¸èƒ½mergre,è¯´å¯¹local fileåšäº†ä¿®æ”¹?

- ![](https://github.com/A-suozhang/MyPicBed/raw/master//img/20211125160347.png)
- ![](https://github.com/A-suozhang/MyPicBed/raw/master//img/20211125160400.png)

-  æœ¬è´¨åŸå› æ˜¯: **åœ¨è¿œç¨‹çš„å…¶ä»–åœ°æ–¹ 	deleteäº†æ–‡ä»¶,ä½†æ˜¯æœ¬åœ°ä»ç„¶ä¿ç•™äº†**
-  æŸ¥çœ‹è¢«ignoreçš„file `git ls-files --ignored --exclude-standard -z `


### æœ‰æ—¶å€™ä»gitä¸Šä¸‹è½½ä¸œè¥¿ä¸€ç›´æŠ¥é”™ `curl Failed to connect to raw.githubusercontent.com port 443: Connection refuse`

- å¯èƒ½æ˜¯DNSæ±¡æŸ“[å‚è€ƒè¿™ä¸ªgit issue](https://github.com/hawtim/blog/issues/10)

### git statuså‡ºä¸€å¤§å †æ–‡ä»¶ï¼Œä½†æ˜¯git diffæ–‡ä»¶å¹¶æ²¡æœ‰æ”¹åŠ¨

- å‚è€ƒ[è¿™ä¸ª](https://stackoverflow.com/questions/14564946/git-status-shows-changed-files-but-git-diff-doesnt)
	- ```git config core.fileMode false```


## Refs
* [yet another gitæ•™ç¨‹](https://www.atlassian.com/git/tutorials/using-branches)
* [å¸¸è§Trouble Shooting](https://blog.csdn.net/qq_15437629/article/details/78761459)
* [æ•™ä½ ç³»ç»Ÿå­¦ä¹ Git](https://www.jianshu.com/p/fe038a97bb3c)
* [git-guide](http://rogerdudler.github.io/git-guide/index.zh.html)
* [ä¸€ä¸ªgitçŸ¥ä¹çš„æ•™å­¦](https://zhuanlan.zhihu.com/p/96631135) 
* [ä¸€ä¸ªgitå­¦ä¹ ç¬”è®°](https://www.jianshu.com/p/9eaf603b4796)
* [Git Community Book](http://gitbook.liuhui998.com/index.html)
* [GitåŸç†ä»‹ç»](https://www.zhihu.com/question/20866683/answer/1078084293)
* [Ohshit-Git](ohshitgit.com)
* [Gitmoji](https://gitmoji.carloscuesta.me/)
* è¯šå¿ƒæ¨èğŸŒˆ[Visualized Git Tutorial](https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1)
